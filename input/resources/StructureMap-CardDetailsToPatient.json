{
    "resourceType": "StructureMap",
    "id": "CardDetailsToPatient",
    "url": "http://moh.tz/fhir/StructureMap/CardDetailsToPatient",
    "version": "0.1.0",
    "name": "CardDetailsToPatient",
    "title": "Map CardDetails Logical Model to Patient",
    "status": "active",
    "publisher": "Ministry of Health Tanzania",
    "jurisdiction": [
        {
            "coding": [
                {
                    "system": "http://unstats.un.org/unsd/methods/m49/m49.htm",
                    "code": "834",
                    "display": "United Republic of Tanzania"
                }
            ]
        }
    ],
    "structure": [
        {
            "url": "http://moh.tz/fhir/StructureDefinition/CardDetails",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Patient",
            "mode": "target"
        }
    ],
    "group": [
        {
            "name": "CardDetailsToPatient",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CardDetails",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Patient",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "SetIdentifierFromCardNo",
                    "source": [
                        {
                            "context": "src",
                            "element": "CardNo",
                            "variable": "cardno"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "identifier",
                            "variable": "id",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "Identifier"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "SetIdentifierValue",
                            "target": [
                                {
                                    "context": "id",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueId": "cardno"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "SetName",
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "name",
                            "variable": "name",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "HumanName"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "SetGivenName",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "FirstName",
                                    "variable": "first"
                                }
                            ],
                            "target": [
                                {
                                    "context": "name",
                                    "contextType": "variable",
                                    "element": "given",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueId": "first"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "SetFamilyName",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "LastName",
                                    "variable": "family"
                                }
                            ],
                            "target": [
                                {
                                    "context": "name",
                                    "contextType": "variable",
                                    "element": "family",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueId": "family"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "SetBirthDate",
                    "source": [
                        {
                            "context": "src",
                            "element": "DateOfBirth",
                            "variable": "dob"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "birthDate",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "dob"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "SetGender",
                    "source": [
                        {
                            "context": "src",
                            "element": "Gender",
                            "variable": "gender"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "gender",
                            "transform": "translate",
                            "parameter": [
                                {
                                    "valueId": "gender"
                                },
                                {
                                    "valueString": "http://moh.tz/fhir/ConceptMap/GenderCodes-TZ"
                                },
                                {
                                    "valueString": "code"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}
