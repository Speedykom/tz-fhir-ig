map "http://speedykom.org/tz-fhir-ig/StructureMap/LabResultToObservation" = LabResultToObservation

// Logical model (source)
uses "http://speedykom.org/tz-fhir-ig/StructureDefinition/LabResult" alias LabResult as source

// Target FHIR resource
uses "http://hl7.org/fhir/StructureDefinition/Observation" alias Observation as target

group LabResultToObservation(source src : LabResult, target tgt : Observation) {

  // Test code â†’ Observation.code
  src.TestCode -> tgt.code.coding as c, 
    c.system = "http://moh.tz/lab/test-code", 
    c.code = src.TestCode;

  // Result value
  src.ResultValue -> tgt.valueString = src.ResultValue;

  // Units (optional: could also be a Quantity if numeric)
  src.Unit -> tgt.valueQuantity.unit = src.Unit;

  // Collection date
  src.CollectionDate -> tgt.effectiveDateTime = src.CollectionDate;
}
